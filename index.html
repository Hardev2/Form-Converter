<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Online Form Converter</title>
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
<script>if (typeof pdfjsLib !== 'undefined') { pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js'; }</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
<link rel="stylesheet" href="form_converter.css">
</head>

<body>

<div class="converter">
  <header class="header">
    <h1>Form Converter</h1>
    <p>Generate PHP form markup for text, radio, and checkbox fields.</p>
  </header>

  <section class="card form-reference-card">
    <h2 class="card-title">Form reference (optional)</h2>
    <p class="hint-block">Upload a PDF or DOCX to <strong>detect fields and convert to form markup</strong> (Version 1 is generated automatically). Or paste text and click Parse. <strong>Fields:</strong> <strong>Full Name - [Text field]</strong>, <strong>Email - [Email field]</strong>, <strong>Label - [Radio Buttons]</strong> / <strong>[Checkbox]</strong> / <strong>[Date Picker]</strong> / <strong>[Time Picker]</strong>, <strong>[Amount]</strong>, <strong>[Age]</strong>, <strong>[Number only]</strong>, <strong>[Upload]</strong>. <strong>Radio/checkbox options</strong> (preferred): one per line with bullet <strong>●</strong>. Alternative: <strong>Options:</strong> then one option per line, or <strong>Options: (Option A&#10;Option B&#10;Other)</strong>.</p>
    <div class="form-group">
      <label>Paste text or upload file</label>
      <textarea id="formReferenceText" rows="4" placeholder="Full Name - [Text field]&#10;Email Address - [Email field]&#10;Sport - [Radio Buttons]"></textarea>
    </div>
    <div class="form-reference-actions">
      <label class="btn btn-primary upload-file-label">
        Upload file & convert
        <input type="file" id="formReferenceFile" accept=".pdf,.docx" onchange="handleFormReferenceFile(event)" class="upload-file-input" />
      </label>
      <button type="button" class="btn btn-secondary" onclick="parseFormReferenceFromInput()">Parse reference</button>
      <button type="button" class="btn btn-secondary" onclick="clearFormReference()">Clear & use manual</button>
      <button type="button" class="btn btn-ghost btn-guide" onclick="openFileGuideModal()" title="See expected file format">File format guide</button>
    </div>
    <div id="parsedPreview" class="parsed-preview empty"></div>
  </section>

  <div class="layout">
    <section class="card">
      <h2 class="card-title">Configuration</h2>

      <div class="form-group">
        <label>Field type</label>
        <select id="fieldType" onchange="toggleRadioOptions()">
          <option value="text">Text</option>
          <option value="radio">Radio</option>
          <option value="checkbox">Checkbox</option>
          <option value="amount">Amount</option>
          <option value="age">Age</option>
          <option value="numberOnly">Number only</option>
          <option value="upload">Upload</option>
        </select>
      </div>

      <div class="form-group">
        <label>Field name(s) <span class="hint">— one per line</span></label>
        <textarea id="fieldNames" rows="4" placeholder="Form Testing&#10;Test"></textarea>
      </div>

      <div id="radioOptionsBox" class="form-group">
        <label>Options <span class="hint">— one per line (newline = new option; spaces on a line = one option)</span></label>
        <textarea id="radioOptions" rows="4" placeholder="Option 1&#10;Option 2&#10;Option 3"></textarea>
      </div>

      <div class="actions">
        <button type="button" class="btn btn-primary" onclick="generate('v1')">Generate Version 1</button>
        <button type="button" class="btn btn-secondary" onclick="generate('v2')">Generate Modern</button>
      </div>
    </section>

    <section class="card">
      <h2 class="card-title">Output</h2>
      <div class="output-wrap">
        <div class="output-header">
          <span class="hint">PHP markup</span>
          <div class="output-actions">
            <button type="button" id="mergeBtn" class="btn-copy" onclick="openMergeModal()" title="Merge selected fields">Merge</button>
            <button type="button" id="undoMergeBtn" class="btn-copy" onclick="undoMerge()" title="Undo last merge">Undo Merge</button>
            <button type="button" id="copyBtn" class="btn-copy" onclick="copyOutput()" title="Copy to clipboard">Copy</button>
          </div>
        </div>
        <textarea id="output" rows="22" placeholder="Click “Generate Version 1” or “Generate Modern” to see the PHP markup here."></textarea>
      </div>
    </section>
  </div>
</div>

<div id="fileGuideModal" class="guide-modal-overlay" aria-hidden="true" onclick="if (event.target === this) closeFileGuideModal()">
  <div class="guide-modal" onclick="event.stopPropagation()">
    <div class="guide-modal-header">
      <h3>File format guide</h3>
      <button type="button" class="guide-modal-close" onclick="closeFileGuideModal()" aria-label="Close">×</button>
    </div>
    <div class="guide-modal-body">
      <p class="guide-intro">Upload a <strong>PDF</strong> or <strong>DOCX</strong> that describes your form. The converter extracts text and looks for field labels and types in these formats.</p>

      <h4>Accepted files</h4>
      <ul>
        <li><strong>.pdf</strong> — text is extracted for parsing</li>
        <li><strong>.docx</strong> — document body text is extracted</li>
      </ul>

      <h4>Field format (preferred)</h4>
      <p>Use a dash before the type in square brackets. Space before the dash is optional. If you use <strong>[Text field]</strong>, the converter may infer <strong>Amount</strong>, <strong>Age</strong>, <strong>Number only</strong>, or <strong>Upload</strong> from the label (e.g. <code>Age - [Text field]</code> → age, <code>Monthly Salary - [Text field]</code> → amount, <code>Quantity - [Text field]</code> → number only, <code>Attach Resume - [Text field]</code> → upload).</p>
      <pre>Full Name - [Text field]
Email Address - [Email field]
Phone - [Text field]
Sport - [Radio Buttons]
Birth Date - [Date Picker]
Start Time - [Time Picker]
Newsletter - [Checkbox]
Monthly Salary - [Amount]
Age - [Age]
Quantity - [Number only]
Attach Resume - [Upload]</pre>

      <h4>Radio & checkbox options</h4>
      <p>List options after the field line. Best: one option per line with a bullet <strong>●</strong> or <strong>•</strong>.</p>
      <pre>Sport - [Radio Buttons]
● Soccer
● Basketball
● Volleyball
● Other</pre>
      <p>Alternatives:</p>
      <ul>
        <li><strong>Options:</strong> then one option per line</li>
        <li><strong>Options: (Option A<br>Option B<br>Other)</strong></li>
      </ul>

      <h4>Supported field types</h4>
      <ul>
        <li><code>[Text field]</code></li>
        <li><code>[Email field]</code></li>
        <li><code>[Radio Buttons]</code></li>
        <li><code>[Checkbox]</code></li>
        <li><code>[Date Picker]</code></li>
        <li><code>[Time Picker]</code></li>
        <li><code>[Amount]</code> — currency/numeric amount</li>
        <li><code>[Age]</code> — age input</li>
        <li><code>[Number only]</code> — numbers only</li>
        <li><code>[Upload]</code> — file upload (e.g. .doc, .docx, .pdf | Max: 10MB)</li>
      </ul>
    </div>
    <div class="guide-modal-actions">
      <button type="button" class="btn btn-primary" onclick="closeFileGuideModal()">Got it</button>
    </div>
  </div>
</div>

<div id="mergeModal" class="merge-modal-overlay" aria-hidden="true">
  <div class="merge-modal">
    <h3>Merge fields</h3>
    <p>Selected <strong id="mergeBlockCount">0</strong> field(s). Merge into:</p>
    <div class="merge-modal-choices">
      <button type="button" data-cols="2">2 columns</button>
      <button type="button" data-cols="3">3 columns</button>
    </div>
    <div class="merge-modal-actions">
      <button type="button" class="btn btn-secondary" onclick="closeMergeModal()">Cancel</button>
      <button type="button" class="btn btn-primary" id="mergeConfirmBtn" onclick="applyMerge()">Merge</button>
    </div>
  </div>
</div>

<script src="form_converter.js"></script>
    

</body>
</html>
